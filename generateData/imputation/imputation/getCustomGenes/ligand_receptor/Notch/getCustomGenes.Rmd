---
title: "Pipleine to assess imputation: performance, cell mapping stability and others."
output:
  BiocStyle::html_document:
    code_folding: hide
    number_sections: yes
    toc: yes  
  html_document:
    code_folding: hide
    number_sections: yes
    toc: yes
    toc_float:
      collapsed: true
    theme: united
---


# Load dependencies and source data

```{r load_data, message=FALSE}

library(Matrix)
library(scran)
library(igraph)
library(reshape2)
library(knitr)
library(scater)
library(scales)
library(biomaRt)
library(VennDiagram)
library(RColorBrewer)
library(tibble)
library(ggplot2)
library(tidyverse)
library(ggpubr)
library(viridis)
library(stringr)
library(ggridges)
library(ggpubr)
library(ggforce)
library(pROC)
library(batchelor)
library(wesanderson)

root.dir = "/nfs/research1/marioni/alsu/spatial/mouse_embryo/"
source(paste0(root.dir, "amScripts_mouseEmbryoFISH/core_functions.R"))
source(paste0(root.dir, "amScripts_mouseEmbryoFISH/visualization_functions.R"))

# genes2keep
genes2keep = c("Notch1", "Notch2", "Notch3", "Notch4", "Dlk1", "Dll1", "Dll3", "Dll4", "Jag1", "Jag2")

# imputation
imputation.embryo1_2 = readRDS(paste0(root.dir, "data/8_5/stitching/imputation/imputation_seq2atlas_logcounts_embryo1z2.rds"))
imputation.embryo1_2 = imputation.embryo1_2[rownames(imputation.embryo1_2) %in% genes2keep, ]
imputation.embryo1_2 = imputation.embryo1_2[order(rownames(imputation.embryo1_2)), ]

imputation.embryo1_5 = readRDS(paste0(root.dir, "data/8_5/stitching/imputation/imputation_seq2atlas_logcounts_embryo1z5.rds"))
imputation.embryo1_5 = imputation.embryo1_5[rownames(imputation.embryo1_5) %in% genes2keep, ]
imputation.embryo1_5 = imputation.embryo1_5[order(rownames(imputation.embryo1_5)), ]

imputation.embryo2_2 = readRDS(paste0(root.dir, "data/8_5/stitching/imputation/imputation_seq2atlas_logcounts_embryo2z2.rds"))
imputation.embryo2_2 = imputation.embryo2_2[rownames(imputation.embryo2_2) %in% genes2keep, ]
imputation.embryo2_2 = imputation.embryo2_2[order(rownames(imputation.embryo2_2)), ]

imputation.embryo2_5 = readRDS(paste0(root.dir, "data/8_5/stitching/imputation/imputation_seq2atlas_logcounts_embryo2z5.rds"))
imputation.embryo2_5 = imputation.embryo2_5[rownames(imputation.embryo2_5) %in% genes2keep, ]
imputation.embryo2_5 = imputation.embryo2_5[order(rownames(imputation.embryo2_5)), ]

imputation.embryo3_2 = readRDS(paste0(root.dir, "data/8_5/stitching/imputation/imputation_seq2atlas_logcounts_embryo3z2.rds"))
imputation.embryo3_2 = imputation.embryo3_2[rownames(imputation.embryo3_2) %in% genes2keep, ]
imputation.embryo3_2 = imputation.embryo3_2[order(rownames(imputation.embryo3_2)), ]

imputation.embryo3_5 = readRDS(paste0(root.dir, "data/8_5/stitching/imputation/imputation_seq2atlas_logcounts_embryo3z5.rds"))
imputation.embryo3_5 = imputation.embryo3_5[rownames(imputation.embryo3_5) %in% genes2keep, ]
imputation.embryo3_5 = imputation.embryo3_5[order(rownames(imputation.embryo3_5)), ]

imputation.custom = cbind(imputation.embryo1_2, 
                          imputation.embryo1_5, 
                          imputation.embryo2_2,
                          imputation.embryo2_5, 
                          imputation.embryo3_2,
                          imputation.embryo3_5)
saveRDS(imputation.custom, file = paste0( root.dir, "data/8_5/stitching/imputation/custom/imputation_Notch.rds"))  

```


#Session Info

```{r sessinf}
sessionInfo()
```
