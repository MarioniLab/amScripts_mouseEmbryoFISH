---
title: "Small one-time runs for the cluster."
author: "Alsu Missarova"
output:
  BiocStyle::html_document:
    code_folding: hide
    number_sections: yes
    toc: yes  
  html_document:
    code_folding: hide
    number_sections: yes
    toc: yes
    toc_float:
      collapsed: true
    theme: united
---



```{r load_data, message=FALSE}

library(Matrix)
library(scran)
library(igraph)
library(reshape2)
library(knitr)
library(scater)
library(scales)
library(biomaRt)
library(VennDiagram)
library(RColorBrewer)
library(tibble)
library(ggplot2)
library(tidyverse)
library(irlba)
library(Hmisc)
library(monocle)


root.dir = "/nfs/research1/marioni/alsu/spatial/mouse_embryo/"
source(paste0(root.dir, "amScripts_mouseEmbryoFISH/core_functions.R"))

# load stitching
counts.stitched = readRDS(paste0(root.dir, "data/8_5/stitching/pca_K10_mean.rds"))
genes.sum = apply(counts.stitched , 1 , sum)
genes.na = sapply(1:nrow(counts.stitched), function(x){
  current.counts = counts.stitched[x,]
  return(sum(is.na(current.counts)))
})

df = data.frame(gene = rownames(counts.stitched), sum.gene = genes.sum, n.na = genes.na)
write.table(df, file = paste0(root.dir, "data/stat_stitched.tab"), row.names = F, col.names = T, sep = "\t") 

```



#Session Info

```{r sessinf}
sessionInfo()
```
